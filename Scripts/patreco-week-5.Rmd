---
title: "patreco-week-5"
author: "wildhtob"
date: "28 5 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Libraries

```{r libraries}

library(readr)
library(sf)
library(terra)
library(dplyr)
library(lubridate)
library(ggplot2)
library(tmap)

```

## Import Data

```{r import data}

wildschwein_BE <- read_delim("Data/wildschwein_BE_2056.csv",",") %>%
  st_as_sf(coords = c("E", "N"), crs = 2056, remove = FALSE)

```

## Task 1: Import and visualize spatial data

```{r import spatial data}

fields <- read_sf("Data/Feldaufnahmen_Fanel.gpkg")

ggplot(fields, aes(fill = Frucht)) +
  geom_sf() +
  coord_sf(datum = 2056)

fields

```

Geometry type: Polygon
Data types of cols: FieldID = dbl, Frucht = chr, geom = Polygon [m]
CRS: CH1903+ / LV95


## Task 2: Annotate trajectories from vector data

Filter wildboard data to the months of May to June

```{r filter wildboar data}

wildschwein_BE

wildschwein_summer <- wildschwein_BE %>% 
  mutate(month = month(DatetimeUTC)) %>% 
  filter(month == 5 | month == 6)

```

Overlay the filtered dataset with field data to verify spatial overlap

```{r overlay wildboar with field data}

ggplot() +
  geom_sf(data = fields, aes(fill = Frucht)) +
  geom_point(data = wildschwein_summer, aes(E, N, colour = TierID)) +
  coord_sf(datum = 2056)

```

Create spatial join between wildboar data and field data

```{r spatial join}

spatial_join <- st_join(x = wildschwein_summer, y = fields)

```


